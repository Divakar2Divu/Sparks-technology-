<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="google-site-verification" content="A--3m12ncsSD2mH2BYvW5OO6RWsLd6eLcrqdxJd6hPc" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Practical Questions and Answers</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            background-color: #f9f9f9;
            margin: 0;
            padding: 0;
        }
        header {
            background-color: #4CAF50;
            color: white;
            padding: 20px;
            text-align: center;
        }
        main {
            padding: 20px;
        }
        .qa-section {
            margin-bottom: 20px;
            background: #ffffff;
            padding: 15px;
            border: 1px solid #ddd;
            border-radius: 8px;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
        }
        .qa-section h3 {
            color: #333;
        }
        .qa-section p {
            margin: 10px 0;
        }
        .qa-section a {
            color: #4CAF50;
            text-decoration: none;
        }
        footer {
            background-color: #333;
            color: white;
            text-align: center;
            padding: 10px;
            position: fixed;
            width: 100%;
            bottom: 0;
        }
    </style>
</head>
<body>
    <header>
        <h1>Practical Questions and Answers</h1>
    </header>
    <main>
        <!-- Question and Answer 1 -->
        <div class="qa-section">
            <h3>Question 1: How to create a simple HTML page?</h3>
            <p>Answer: Use the `<html>`, `<head>`, `<body>` tags to define the basic structure of an HTML page. You can add content inside these tags to build the page.</p>
            <p>Source: <a href="https://www.w3schools.com/html/html_basic.asp" target="_blank">W3Schools</a></p>
        </div>

        <!-- Question and Answer 2 -->
        <div class="qa-section">
            <h3>Question 2: What is the purpose of CSS in web development?</h3>
            <p>Answer: CSS (Cascading Style Sheets) is used to style and layout web pages, including colors, fonts, and responsive designs.</p>
            <p>Source: <a href="https://developer.mozilla.org/en-US/docs/Web/CSS" target="_blank">MDN Web Docs</a></p>
        </div>

        <!-- Question and Answer 3 -->
        <div class="qa-section">
            <h3>Question 3: How do you link an external CSS file to an HTML document?</h3>
            <p>Answer: Use the `<link>` tag inside the `<head>` section of the HTML document. Example: `<link rel="stylesheet" href="styles.css">`</p>
            <p>Source: <a href="https://www.tutorialspoint.com/html/html_css.htm" target="_blank">TutorialsPoint</a></p>
        </div>

        <!-- Question and Answer 4 -->
        <div class="qa-section">
            <h3>Question 4: How can you make a website responsive?</h3>
            <p>Answer: Use CSS media queries to apply different styles based on screen sizes. Example: `@media (max-width: 768px) { ... }`</p>
            <p>Source: <a href="https://www.w3schools.com/css/css_rwd_mediaqueries.asp" target="_blank">W3Schools</a></p>
        </div>
    </main>
    <footer>
        <p>&copy; 2025 Practical Questions and Answers. All Rights Reserved.</p>
    </footer>
</body>
        </html>
    






from docx import Document

# Create a Word document

doc = Document()

doc.add_heading("Optimized Practical Codes for Spark", level=1)



# Practical 2

doc.add_heading("Practical 2: Filtering RDDs and Finding Minimum Temperature by Location", level=2)

doc.add_paragraph("""

from pyspark import SparkConf, SparkContext



# Initialize Spark

conf = SparkConf().setMaster("local").setAppName("MinTemperature")

sc = SparkContext(conf=conf)



# Function to parse lines

def parseLine(line):

    fields = line.split(',')

    return fields[0], fields[2], float(fields[3]) * 0.1 * (9/5) + 32



# Load data and filter TMIN records

lines = sc.textFile("1800.csv")

minTemps = (

    lines.map(parseLine)

    .filter(lambda x: x[1] == "TMIN")

    .map(lambda x: (x[0], x[2]))

    .reduceByKey(min)

)



# Show results

for station, temp in minTemps.collect():

    print(f"{station}\\t{temp:.2f}F")

""")



# Practical 3

doc.add_heading("Practical 3: Counting Word Occurrences using flatMap", level=2)

doc.add_paragraph("""

from pyspark import SparkConf, SparkContext



# Initialize Spark

conf = SparkConf().setMaster("local").setAppName("WordCount")

sc = SparkContext(conf=conf)



# Load data and count words

lines = sc.textFile("text.txt")

wordCounts = (

    lines.flatMap(lambda line: line.split())

    .map(lambda word: (word, 1))

    .reduceByKey(lambda x, y: x + y)

)



# Show results

for word, count in wordCounts.collect():

    print(f"{word}: {count}")

""")



# Practical 4

doc.add_heading("Practical 4: Executing SQL Commands on DataFrames", level=2)

doc.add_paragraph("""

from pyspark.sql import SparkSession



# Initialize SparkSession

spark = SparkSession.builder.appName("SQLCommands").getOrCreate()



# Load data into DataFrame

df = spark.read.csv("data.csv", header=True, inferSchema=True)



# Register DataFrame as SQL table

df.createOrReplaceTempView("data")



# Execute SQL queries

result = spark.sql("SELECT column1, column2 FROM data WHERE column3 > 100")



# Show results

result.show()

""")



# Practical 5

doc.add_heading("Practical 5: Total Spent by Customer with DataFrames", level=2)

doc.add_paragraph("""

from pyspark.sql import SparkSession



# Initialize SparkSession

spark = SparkSession.builder.appName("TotalSpent").getOrCreate()



# Load data into DataFrame

df = spark.read.csv("customer-orders.csv", header=False, inferSchema=True)

df = df.withColumnRenamed("_c0", "CustomerID").withColumnRenamed("_c2", "Amount")



# Calculate total spent

totalSpent = df.groupBy("CustomerID").sum("Amount").withColumnRenamed("sum(Amount)", "TotalSpent")



# Show results

totalSpent.show()

""")



# Practical 6

doc.add_heading("Practical 6: Use Broadcast Variables for Movie Names", level=2)

doc.add_paragraph("""

from pyspark import SparkConf, SparkContext



# Initialize Spark

conf = SparkConf().setMaster("local").setAppName("BroadcastMovieNames")

sc = SparkContext(conf=conf)



# Load movie names into a dictionary

movieNames = {1: "Toy Story", 2: "Jumanji", 3: "Grumpier Old Men"}

broadcastMovieNames = sc.broadcast(movieNames)



# Load data and map movie IDs to names

lines = sc.textFile("ratings.csv")

movies = lines.map(lambda x: int(x.split(',')[1])).map(lambda id: broadcastMovieNames.value.get(id, "Unknown"))



# Show results

for movie in movies.collect():

    print(movie)

""")



# Practical 7

doc.add_heading("Practical 7: Using Spark ML for Movie Recommendations", level=2)

doc.add_paragraph("""

from pyspark.sql import SparkSession

from pyspark.ml.recommendation import ALS



# Initialize SparkSession

spark = SparkSession.builder.appName("MovieRecommendation").getOrCreate()



# Load data into DataFrame

data = spark.read.csv("ratings.csv", header=True, inferSchema=True)



# Prepare ALS model

als = ALS(maxIter=5, regParam=0.01, userCol="userId", itemCol="movieId", ratingCol="rating")

model = als.fit(data)



# Make recommendations for all users

recommendations = model.recommendForAllUsers(5)



# Show results

recommendations.show()

""")



# Practical 8

doc.add_heading("Practical 8: Structured Streaming with Most-Viewed URLs", level=2)

doc.add_paragraph("""

from pyspark.sql import SparkSession



# Initialize SparkSession

spark = SparkSession.builder.appName("StructuredStreaming").getOrCreate()



# Read streaming data

stream = spark.readStream.format("socket").option("host", "localhost").option("port", 9999).load()



# Process data

urls = stream.selectExpr("CAST(value AS STRING)").groupBy("value").count()



# Write streaming results to console

query = urls.writeStream.outputMode("complete").format("console").start()

query.awaitTermination()

""")



# Save the document

file_path = "/mnt/data/Spark_Practicals_Optimized.docx"

doc.save(file_path)

file_path
